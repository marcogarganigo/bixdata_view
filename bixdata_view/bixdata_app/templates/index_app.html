{% extends 'base.html' %}
{% load static %}
{% block body %}
<!--
<nav class="navbar navbar-expand-lg bg-body-tertiary" style="background-color: white !important">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Bixapp</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <i class="mdi mdi-menu"></i>
          </button>

            <div class="navbar-collapse collapse" id="navbarSupportedContent" style="">
             <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item" onclick="getDashboard()">
                <a class="nav-link active" aria-current="page">Dashboard</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="table-view.html">Tables</a>
              </li>
                 {% for dashboard in active_dashboards %}
                  <li class="nav-item" onclick="getDashboard('{{ dashboard.id }}')">
                    <a class="nav-link active" onclick="setColor(this)">{{ dashboard.name }}</a>
                  </li>
                {% endfor %}
                </ul>

            <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
          </div>


            <a class="nav-link dropdown-toggle nav-user arrow-none me-0" data-bs-toggle="dropdown"
               role="button" aria-haspopup="false" aria-expanded="false">
                <span class="account-user-avatar">
                    <img src="{% static 'images/users/' %}{{ username }}.png?v=" + time alt=""
                         class="rounded-circle">
                </span>
                <span>
                    <span class="user-hover">
                        <span class="account-user-name">{{ username }}</span>
                        <span class="account-position">{{ role }}</span>
                    </span>
                </span>
            </a>
            <div
                    class="dropdown-menu dropdown-menu-end dropdown-menu-animated topbar-dropdown-menu profile-dropdown">
                    -->
                <!-- item-->
    <!--
                <div class=" dropdown-header noti-title">
                    <h6 class="text-overflow m-0">Welcome !</h6>
                </div>

                <a class="dropdown-item notify-item" onclick="get_account()">
                    <i class="mdi mdi-lifebuoy me-1"></i>

                    <span>Account</span>
                </a>


                <a onclick="get_settings()" class="dropdown-item notify-item">
                    <i class="mdi mdi-account-edit me-1"></i>
                    <span>Settings</span>
                </a>



                <a class="dropdown-item notify-item" onclick="support('ticketbixdata')">
                    <i class="mdi mdi-lifebuoy me-1"></i>

                    <span>Support</span>
                </a>





                <script>
                    function openSupportModal() {
                        $('#supportModal').modal('show');
                    }
                </script>


                <a href="{% url 'logout' %}" class="dropdown-item notify-item">
                    <i class="mdi mdi-logout me-1"></i>
                    <span>Logout</span>
                </a>
            </div>

        </div>

      </nav>
-->

    <div class="navbar-custom topnav-navbar">
                <div class="container-fluid detached-nav">

                    <!-- Topbar Logo -->
                    <div class="logo-topbar">
                        <!-- Logo light -->
                        <a class="sidebar-brand d-flex align-items-center justify-content-center"
                           href="{{ index.html }}">

                            <p class="shadow-sm p-0 mb-0 bg-white rounded"
                               style="width: 50px; color: red; margin-right: 1px;"> <span class="logo-sm">
                            <img src="{% static 'images/logos/logo_big_' %}{{ theme }}.jpg" alt="small logo"
                                 height="55">

                        </span></p>

                            <p class=" mb-0" style="width: 50px; color: white; margin-left: 0px;"> <span
                                    class="logo-sm">
                           <img src="{% static 'images/logos/logo_big_' %}{{ theme }}.jpg" alt="small logo"
                                height="55">
                        </span></p>
                        </a>

                        <!-- Logo Dark -->
                        <a href="{{ index.html }}" class="logo-dark">
                            <span class="logo-lg">
                                <img src="{% static 'images/logo-dark.png' %}" alt="dark logo" height="22">
                            </span>
                            <span class="logo-sm">
                                <img src="{% static 'images/logo-dark-sm.png' %}" alt="small logo" height="22">
                            </span>
                        </a>
                    </div>

                    <!-- Sidebar Menu Toggle Button -->
                    <button class="button-toggle-menu" id="toggle-menu" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <i class="mdi mdi-menu"></i>
                    </button>





                    <!-- Horizontal Menu Toggle Button -->
                    <button class="navbar-toggle" data-bs-toggle="collapse" data-bs-target="#topnav-menu-content">
                        <div class="lines">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </button>

                    <ul class="list-unstyled topbar-menu float-end mb-0">
                        <li class="dropdown notification-list d-lg-none">
                            <a class="nav-link dropdown-toggle arrow-none" data-bs-toggle="dropdown"
                               role="button" aria-haspopup="false" aria-expanded="false">
                                <i class="ri-search-line noti-icon"></i>
                            </a>
                            <div class="dropdown-menu dropdown-menu-animated dropdown-lg p-0">
                                <form class="p-3">
                                    <input type="search" class="form-control" placeholder="Search ..."
                                           aria-label="Recipient's username">
                                </form>
                            </div>
                        </li>

                        <!--
                        <li class="dropdown notification-list">
                            <a class="nav-link dropdown-toggle arrow-none" data-bs-toggle="dropdown" href="{% url 'under_construction' %}">
                                <i class="ri-notification-3-line noti-icon"></i>
                                <span class="noti-icon-badge"></span>
                            </a>

                        </li>
                    -->

                        <li onclick="get_settings()" class="notification-list d-none d-sm-inline-block">
                            <a class="nav-link" data-bs-toggle="offcanvas" href="#theme-settings-offcanvas">
                                <i class="ri-settings-3-line noti-icon" data-bs-toggle="tooltip"
                                   data-bs-placement="bottom" data-bs-title="Impostazioni"></i>
                            </a>
                        </li>

                        <script>
                            const time = Date.now();
                        </script>

                        <li class="dropdown notification-list">
                            <a class="nav-link dropdown-toggle nav-user arrow-none me-0" data-bs-toggle="dropdown"
                               role="button" aria-haspopup="false" aria-expanded="false">
                                <span class="account-user-avatar">
                                    <img src="{% static 'images/users/' %}{{ username }}.png?v=" + time alt=""
                                         class="rounded-circle">
                                </span>
                                <span>
                                    <span class="user-hover">
                                        <span class="account-user-name">{{ username }}</span>
                                        <span class="account-position">{{ role }}</span>
                                    </span>
                                </span>
                            </a>
                            <div
                                    class="dropdown-menu dropdown-menu-end dropdown-menu-animated topbar-dropdown-menu profile-dropdown">
                                <!-- item-->
                                <div class=" dropdown-header noti-title">
                                    <h6 class="text-overflow m-0">Welcome !</h6>
                                </div>

                                <a class="dropdown-item notify-item" onclick="get_account()">
                                    <i class="mdi mdi-lifebuoy me-1"></i>

                                    <span>Account</span>
                                </a>

                                <!-- item-->
                                <a onclick="get_settings()" class="dropdown-item notify-item">
                                    <i class="mdi mdi-account-edit me-1"></i>
                                    <span>Settings</span>
                                </a>


                                <!-- item-->
                                <a class="dropdown-item notify-item" onclick="support('ticketbixdata')">
                                    <i class="mdi mdi-lifebuoy me-1"></i>

                                    <span>Support</span>
                                </a>


                                <script>
                                    function support(tableid) {
                                        $('#newRecordModal').modal('show');
                                        var serialized_data = [];
                                        serialized_data.push({name: 'tableid', value: tableid});
                                        serialized_data.push({name: 'function', value: 'insert'});
                                        serialized_data.push({name: 'http_response', value: true});
                                        $.ajax({
                                            type: "POST",
                                            url: "{% url 'get_record_fields' %}",
                                            data: serialized_data,
                                            success: function (response) {
                                                $("#fullwidth_modal_newrecord").html(response);

                                            },
                                            error: function () {
                                                $("#bixdata_recordcard_container").html(response);
                                            }
                                        });


                                    }
                                </script>


                                <script>
                                    function openSupportModal() {
                                        $('#supportModal').modal('show');
                                    }
                                </script>

                                <!-- item-->
                                <a href="{% url 'logout' %}" class="dropdown-item notify-item">
                                    <i class="mdi mdi-logout me-1"></i>
                                    <span>Logout</span>
                                </a>
                            </div>
                        </li>
                    </ul>

                    <!-- Topbar Search Form -->
                     <div class="app-search dropdown">
                    <!--
                        <form>
                            <div class="input-group">
                                <input type="search" class="form-control dropdown-toggle" placeholder="Search..."
                                       id="top-search" autocomplete="off">
                                <span class="mdi mdi-magnify search-icon"></span>
                                <button class="input-group-text btn btn-primary" type="submit"
                                        style="background-color: #ff5b5b; border: #ff5b5b">Cerca
                                </button>
                            </div>
                        </form>


                        <div class="dropdown-menu dropdown-menu-animated dropdown-lg" id="search-dropdown">
                            <h4>Qui non c'è ancora niente ma ci stiamo lavorando</h4>
                            <img src="{% static 'images/mauro&lorenzo.jpg' %}" width="300px">
                        </div>
                        -->
                        <button style="width: 100%; font-size: 20pt; font-weight: bold; heigth: 100%" type="button" class="btn btn-outline-danger  records-button" onclick="newRecord('task')">Usa i TASK, sono comodi e ti faranno risparmiare tempo</button>
                    </div>
                    
                    
                </div>
                <div class="navbar-collapse collapse" id="navbarSupportedContent" style="">
             <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item" onclick="getDashboard()">
                <a class="nav-link active" aria-current="page">Dashboard</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="table-view.html">Tables</a>
              </li>
                 {% for dashboard in active_dashboards %}
                  <li class="nav-item" onclick="getDashboard('{{ dashboard.id }}')">
                    <a class="nav-link active" onclick="setColor(this)">{{ dashboard.name }}</a>
                  </li>
                {% endfor %}
                </ul>

            <!--
                <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
            -->
          </div>
    
    
            </div>

    <div id="content_container" class="container" style="height: 100%; width: 100%"></div>


    <script>
     function getDashboard(dashboardid) {
                //$("#content_container").load('/loading/');
                $.ajax({
                    type: "POST",
                    crossDomain: true,
                    data: {
                        'size': 'small',
                        'dashboard_id': dashboardid
                    },
                    url: "{% url 'dashboard' %}",
                    success: function (response) {
                        $("#content_container").html(response);
                        $('[data-toggle="tooltip"]').tooltip();
                    },
                    error: function (response) {
                        $("#content_container").html(response);
                    }
                });
            }


    function support(tableid) {
        $('#newRecordModal').modal('show');
        var serialized_data = [];
        serialized_data.push({name: 'tableid', value: tableid});
        serialized_data.push({name: 'function', value: 'insert'});
        serialized_data.push({name: 'http_response', value: true});
        $.ajax({
            type: "POST",
            url: "{% url 'get_record_fields' %}",
            data: serialized_data,
            success: function (response) {
                $("#fullwidth_modal_newrecord").html(response);

            },
            error: function () {
                $("#bixdata_recordcard_container").html(response);
            }
        });
    }

    function get_settings() {
        //$("#content_container").load('/loading/');
        $.ajax({
            type: "POST",
            crossDomain: true,
            url: "{% url 'get_settings' %}",
            success: function (response) {
                $("#content_container").html(response);
                $('[data-toggle="tooltip"]').tooltip();
            },
            error: function (response) {
                $("#content_container").html(response);
            }
        });
    }

    </script>


{% endblock %}