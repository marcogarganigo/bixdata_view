{"version":3,"file":"bootstrap-autocomplete.js","sources":["../../src/js/util.js","../../src/js/autocomplete.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v4.3.1): util.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport $ from 'jquery'\n\n/**\n * ------------------------------------------------------------------------\n * Private TransitionEnd Helpers\n * ------------------------------------------------------------------------\n */\n\nconst TRANSITION_END = 'transitionend'\nconst MAX_UID = 1000000\nconst MILLISECONDS_MULTIPLIER = 1000\n\n// Shoutout AngusCroll (https://goo.gl/pxwQGp)\nfunction toType(obj) {\n  return {}.toString.call(obj).match(/\\s([a-z]+)/i)[1].toLowerCase()\n}\n\nfunction getSpecialTransitionEndEvent() {\n  return {\n    bindType: TRANSITION_END,\n    delegateType: TRANSITION_END,\n    handle(event) {\n      if ($(event.target).is(this)) {\n        return event.handleObj.handler.apply(this, arguments) // eslint-disable-line prefer-rest-params\n      }\n      return undefined // eslint-disable-line no-undefined\n    }\n  }\n}\n\nfunction transitionEndEmulator(duration) {\n  let called = false\n\n  $(this).one(Util.TRANSITION_END, () => {\n    called = true\n  })\n\n  setTimeout(() => {\n    if (!called) {\n      Util.triggerTransitionEnd(this)\n    }\n  }, duration)\n\n  return this\n}\n\nfunction setTransitionEndSupport() {\n  $.fn.emulateTransitionEnd = transitionEndEmulator\n  $.event.special[Util.TRANSITION_END] = getSpecialTransitionEndEvent()\n}\n\n/**\n * --------------------------------------------------------------------------\n * Public Util Api\n * --------------------------------------------------------------------------\n */\n\nconst Util = {\n\n  TRANSITION_END: 'bsTransitionEnd',\n\n  getUID(prefix) {\n    do {\n      // eslint-disable-next-line no-bitwise\n      prefix += ~~(Math.random() * MAX_UID) // \"~~\" acts like a faster Math.floor() here\n    } while (document.getElementById(prefix))\n    return prefix\n  },\n\n  getSelectorFromElement(element) {\n    let selector = element.getAttribute('data-target')\n\n    if (!selector || selector === '#') {\n      const hrefAttr = element.getAttribute('href')\n      selector = hrefAttr && hrefAttr !== '#' ? hrefAttr.trim() : ''\n    }\n\n    try {\n      return document.querySelector(selector) ? selector : null\n    } catch (err) {\n      return null\n    }\n  },\n\n  getTransitionDurationFromElement(element) {\n    if (!element) {\n      return 0\n    }\n\n    // Get transition-duration of the element\n    let transitionDuration = $(element).css('transition-duration')\n    let transitionDelay = $(element).css('transition-delay')\n\n    const floatTransitionDuration = parseFloat(transitionDuration)\n    const floatTransitionDelay = parseFloat(transitionDelay)\n\n    // Return 0 if element or transition duration is not found\n    if (!floatTransitionDuration && !floatTransitionDelay) {\n      return 0\n    }\n\n    // If multiple durations are defined, take the first\n    transitionDuration = transitionDuration.split(',')[0]\n    transitionDelay = transitionDelay.split(',')[0]\n\n    return (parseFloat(transitionDuration) + parseFloat(transitionDelay)) * MILLISECONDS_MULTIPLIER\n  },\n\n  reflow(element) {\n    return element.offsetHeight\n  },\n\n  triggerTransitionEnd(element) {\n    $(element).trigger(TRANSITION_END)\n  },\n\n  // TODO: Remove in v5\n  supportsTransitionEnd() {\n    return Boolean(TRANSITION_END)\n  },\n\n  isElement(obj) {\n    return (obj[0] || obj).nodeType\n  },\n\n  typeCheckConfig(componentName, config, configTypes) {\n    for (const property in configTypes) {\n      if (Object.prototype.hasOwnProperty.call(configTypes, property)) {\n        const expectedTypes = configTypes[property]\n        const value         = config[property]\n        const valueType     = value && Util.isElement(value)\n          ? 'element' : toType(value)\n\n        if (!new RegExp(expectedTypes).test(valueType)) {\n          throw new Error(\n            `${componentName.toUpperCase()}: ` +\n            `Option \"${property}\" provided type \"${valueType}\" ` +\n            `but expected type \"${expectedTypes}\".`)\n        }\n      }\n    }\n  },\n\n  findShadowRoot(element) {\n    if (!document.documentElement.attachShadow) {\n      return null\n    }\n\n    // Can find the shadow root otherwise it'll return the document\n    if (typeof element.getRootNode === 'function') {\n      const root = element.getRootNode()\n      return root instanceof ShadowRoot ? root : null\n    }\n\n    if (element instanceof ShadowRoot) {\n      return element\n    }\n\n    // when we don't find a shadow root\n    if (!element.parentNode) {\n      return null\n    }\n\n    return Util.findShadowRoot(element.parentNode)\n  }\n}\n\nsetTransitionEndSupport()\n\nexport default Util\n","/**\n * --------------------------------------------------------------------------\n * Bootstrap Autocomplete (v0.2.0): autocomplete.js\n * Licensed under MIT (https://github.com/iqbalfn/bootstrap-autocomplete/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport $ from 'jquery'\nimport Util from './util'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME               = 'autocomplete'\nconst VERSION            = '0.2.0'\nconst DATA_KEY           = 'bs.autocomplete'\nconst EVENT_KEY          = `.${DATA_KEY}`\nconst DATA_API_KEY       = '.data-api'\nconst JQUERY_NO_CONFLICT = $.fn[NAME]\n\nconst Default = {\n    list            : null,\n\n    prefetch        : null,\n\n    filter          : null,\n    filterDelay     : 300,\n    filterMinChars  : 1,\n    filterRelation  : null,\n\n    maxResult       : 10,\n\n    onPick          : null,\n    onItemRendered  : null,\n\n    preProcess      : null\n}\n\nconst DefaultType = {\n    list            : '(null|string|element)',\n\n    prefetch        : '(null|string)',\n\n    filter          : '(null|string)',\n    filterDelay     : 'number',\n    filterMinChars  : 'number',\n    filterRelation  : '(null|object)',\n\n    maxResult       : 'number',\n\n    preProcess      : '(null|function)',\n\n    onPick          : '(null|function)',\n    onItemRendered  : '(null|function)'\n}\n\nconst Event = {\n    BLUR_DATA_API       : `blur${EVENT_KEY}${DATA_API_KEY}`,\n    CLICK_DATA_API      : `click${EVENT_KEY}${DATA_API_KEY}`,\n    KEYDOWN_DATA_API    : `keydown${EVENT_KEY}${DATA_API_KEY}`,\n    INPUT_DATA_API      : `input${EVENT_KEY}${DATA_API_KEY}`,\n\n    PICK                : `pick${EVENT_KEY}`,\n    ITEM_RENDER         : `itemrender${EVENT_KEY}`\n}\n\nconst ClassName = {\n    DROPDOWN_MENU : 'dropdown-menu',\n    DROPDOWN_ITEM : 'dropdown-item'\n}\n\nconst KeyCode = {\n    ARROW_DOWN  : 40,\n    ARROW_UP    : 38,\n    ENTER       : 13,\n    ESCAPE      : 27\n}\n\nconst Selector = {}\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass Autocomplete {\n    constructor(element, config) {\n        this._config    = this._getConfig(config)\n        this._element   = element\n\n        this._items     = []\n        this._labels    = {}\n\n        this._isShown   = false\n        this._dropdown  = null\n        this._spinner   = null\n        this._result    = []\n        this._query     = ''\n        this._preventClose = false\n        this._timer     = null\n        this._relations = null\n\n        if(element.hasAttribute('list')){\n            this._config.list = '#' + element.getAttribute('list')\n            element.removeAttribute('list')\n        }\n\n        if(!this._config.list && !this._config.prefetch && !this._config.filter)\n            throw new TypeError('No data source provided')\n\n        if(this._config.filterRelation)\n            this._handleRelations()\n\n        element.setAttribute('autocomplete', 'off')\n\n        this._makeDropdown()\n        this._makeSpinner()\n        this._fetchPresetData()\n        this._addElementListener()\n    }\n\n    // Getters\n\n    static get VERSION() {\n        return VERSION\n    }\n\n    static get Default() {\n        return Default\n    }\n\n    // Public\n\n    show(){\n        if(this._isShown)\n            return\n\n        if(this._result.length)\n            this._showDropdown()\n    }\n\n    hide(){\n        if(!this._isShown)\n            return\n\n        this._hideDropdown()\n    }\n\n    dispose() {\n        $(this._element).off(EVENT_KEY)\n\n        $.removeData(this._element, DATA_KEY)\n\n        this._config    = null\n        this._element   = null\n        this._items     = null\n        this._labels    = null\n        this._isShown   = null\n        this._dropdown  = null\n        this._spinner   = null\n        this._result    = null\n        this._query     = null\n        this._preventClose = null\n        if(this._timer)\n            clearTimeout(this._timer)\n        this._timer     = null\n    }\n\n    // Private\n\n    _addElementListener(){\n        $(this._element).on(Event.KEYDOWN_DATA_API, e => {\n            let prevent = false\n\n            switch(e.keyCode){\n                case KeyCode.ARROW_DOWN:\n                    if(e.altKey && !this._isShown){\n                        this._query = this._element.value.trim().toLowerCase()\n\n                        if(this._query){\n                            this._findFromList()\n                            prevent = true\n                        }\n                    }else{\n                        this._focusNext()\n                        prevent = true\n                    }\n                    break;\n\n                case KeyCode.ARROW_UP:\n                    this._focusPrev()\n                    prevent = true\n                    break;\n\n                case KeyCode.ENTER:\n                    if(this._isShown){\n                        let item = $(this._dropdown).children('.active').get(0)\n                        if(!item)\n                            item = $(this._dropdown).children(':first-child').get(0)\n\n                        if(item)\n                            this._selectItem(item)\n\n                        this.hide()\n                        prevent = true\n                    }\n                    break;\n\n                case KeyCode.ESCAPE:\n                    prevent = true\n                    this.hide()\n                    break;\n            }\n\n            if(prevent)\n                e.preventDefault()\n        })\n\n        $(this._element).on(Event.INPUT_DATA_API, e => {\n            this._query = this._element.value.trim().toLowerCase()\n\n            if(!this._query){\n                this._truncateDropdown()\n                this.hide()\n            }else{\n                this._findFromList()\n            }\n        })\n\n        $(this._element).on(Event.BLUR_DATA_API, e => {\n            if(this._preventClose)\n                return\n            setTimeout(() => this.hide(), 150)\n        })\n    }\n\n    _fetchPresetData(){\n        // from datalist\n        if(this._config.list){\n            let dataList = this._config.list\n            if(typeof dataList === 'string')\n                dataList = document.querySelector(this._config.list)\n\n            if(dataList){\n                Array.from(dataList.children).forEach(o => {\n                    let val = o.innerHTML.toLowerCase()\n                    if(this._items.includes(val))\n                        return\n\n                    this._items.push(val)\n                    this._labels[val] = o.innerHTML\n                })\n            }\n        }\n\n        // from prefetch\n        if(this._config.prefetch){\n            this._showSpinner()\n            $.get(this._config.prefetch, res => {\n                this._hideSpinner()\n                if(this._config.preProcess)\n                    res = this._config.preProcess(res)\n\n                res.forEach(i => {\n                    let val = i.toLowerCase()\n                    if(this._items.includes(val))\n                        return\n                    this._items.push(val)\n                    this._labels[val] = i\n                })\n            })\n        }\n    }\n\n    _findFromAjax(){\n        if(!this._config.filter)\n            return\n        if(this._dropdown.children.length >= this._config.maxResult)\n            return\n\n        if(this._timer)\n            clearTimeout(this._timer)\n\n        let vval = this._query\n        this._timer = setTimeout(() => {\n            if(vval != this._query)\n                return\n            this._showSpinner()\n\n            let url = this._config.filter\n                .replace(/%23/g, '#')\n                .replace('#QUERY#', this._query)\n\n            if(this._relations){\n                let sep = url.includes('?') ? '&' : '?'\n\n                for(let k in this._relations){\n                    let el = this._relations[k]\n                    let val= $(el).val()\n                    if(!val)\n                        continue;\n\n                    url+= `${sep}${k}=${val}`\n                    sep = '&'\n                }\n            }\n\n            $.get(url, res => {\n                this._hideSpinner()\n                if(this._config.preProcess)\n                    res = this._config.preProcess(res)\n\n                let local = []\n                res.forEach(i => {\n                    let val = i.toLowerCase()\n                    if(this._items.includes(val))\n                        return\n\n                    this._items.push(val)\n                    this._labels[val] = i\n\n                    local.push(i)\n                    this._result.push(i)\n                })\n\n                if(local.length)\n                    this._renderItem(local)\n\n                if(this._result.length)\n                    this.show()\n                else\n                    this.hide()\n            })\n        }, this._config.filterDelay)\n    }\n\n    _findFromList(){\n        this._truncateDropdown()\n        this._result = []\n\n        let local = []\n        this._items.forEach(i => {\n            if(!i.includes(this._query))\n                return\n\n            let label = this._labels[i]\n\n            if(this._result.includes(label))\n                return\n\n            local.push(label)\n            this._result.push(label)\n        })\n\n        // now render the result\n        if(local.length){\n            this._renderItem(local)\n            this.show()\n        }else{\n            this.hide()\n        }\n\n        this._findFromAjax()\n    }\n\n    _focusNext(){\n        let next = $(this._dropdown).children(':first-child').get(0)\n        let focused = $(this._dropdown).children('.active').get(0)\n\n        if(focused){\n            focused.classList.remove('active')\n            let tmpNext = $(focused).next().get(0)\n            if(tmpNext)\n                next = tmpNext\n        }\n\n        if(next)\n            next.classList.add('active')\n    }\n\n    _focusPrev(){\n        let next = $(this._dropdown).children(':last-child').get(0)\n        let focused = $(this._dropdown).children('.active').get(0)\n\n        if(focused){\n            focused.classList.remove('active')\n            let tmpNext = $(focused).prev().get(0)\n            if(tmpNext)\n                next = tmpNext\n        }\n\n        if(next)\n            next.classList.add('active')\n    }\n\n    _getConfig(config) {\n        config = {\n            ...Default,\n            ...config\n        }\n        Util.typeCheckConfig(NAME, config, DefaultType)\n        return config\n    }\n\n    _handleRelations(){\n        this._relations = []\n        for(let name in this._config.filterRelation){\n            let selector = this._config.filterRelation[name];\n            this._relations[name] = $(selector).get(0)\n            $(this._relations[name]).change(e => {\n                this._element.value = ''\n                $(this._element).change() // we need to trigger this manually\n                this._items = []\n            });\n        }\n    }\n\n    _hideDropdown(){\n        this._isShown = false\n        this._dropdown.classList.remove('show')\n    }\n\n    _hideSpinner(){\n        this._spinner.style.display = 'none'\n    }\n\n    _makeDropdown(){\n        this._element.parentNode.style.position = 'relative'\n\n        let tmpl = '<div class=\"dropdown-menu\" style=\"width:100%\"></div>'\n\n        this._dropdown = $(tmpl).appendTo(this._element.parentNode).get(0)\n\n    }\n\n    _makeSpinner(){\n        let tmpl = '<div class=\"spinner-border spinner-border-sm text-secondary\" role=\"status\"></div>'\n\n        this._spinner = $(tmpl).appendTo(this._element.parentNode).get(0)\n\n        $(this._spinner).css({\n            position : 'absolute',\n            right    : $(this._element).css('padding-right'),\n            top      : (this._element.offsetTop + ((this._element.offsetHeight - this._spinner.offsetHeight)/2)) + 'px'\n        })\n\n        this._hideSpinner()\n    }\n\n    _renderItem(items){\n        items.forEach(i => {\n            if(this._dropdown.children.length >= this._config.maxResult)\n                return\n\n            let item = $('<a class=\"dropdown-item\" href=\"#\"></a>')\n            let itemEl = item.get(0)\n\n            item.text(i).appendTo(this._dropdown)\n\n            if(this._config.onItemRendered)\n                this._config.onItemRendered(this._element, itemEl)\n\n            const renderEvent = $.Event(Event.ITEM_RENDER, {item:itemEl})\n\n            $(this._element).trigger(renderEvent)\n\n            item.on(Event.CLICK_DATA_API, e => {\n                this._selectItem(e.target);\n                this._preventClose  = true\n                this.hide()\n                e.preventDefault()\n                this._preventClose = false\n            })\n        })\n    }\n\n    _selectItem(item){\n        this._element.value = item.innerText\n\n        if(this._config.onPick)\n            this._config.onPick(this._element, item)\n\n        const pickEvent = $.Event(Event.PICK, {item})\n        $(this._element).trigger(pickEvent)\n    }\n\n    _showDropdown(){\n        this._isShown = true\n        this._dropdown.classList.add('show')\n    }\n\n    _showSpinner(){\n        this._spinner.style.display = 'inline-block'\n    }\n\n    _truncateDropdown(){\n        this._dropdown.innerHTML = ''\n    }\n\n    // Static\n\n    static _jQueryInterface(config, relatedTarget) {\n        return this.each(function () {\n            let data = $(this).data(DATA_KEY)\n            const _config = {\n                ...Default,\n                ...$(this).data(),\n                ...typeof config === 'object' && config ? config : {}\n            }\n\n            if (!data) {\n                data = new Autocomplete(this, _config)\n                $(this).data(DATA_KEY, data)\n            }\n\n            if (typeof config === 'string') {\n                if (typeof data[config] === 'undefined')\n                    throw new TypeError(`No method named \"${config}\"`)\n                data[config](relatedTarget)\n            }\n        })\n    }\n}\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n\n$.fn[NAME] = Autocomplete._jQueryInterface\n$.fn[NAME].Constructor = Autocomplete\n$.fn[NAME].noConflict = () => {\n  $.fn[NAME] = JQUERY_NO_CONFLICT\n  return Autocomplete._jQueryInterface\n}\n\nexport default Autocomplete\n"],"names":["TRANSITION_END","MAX_UID","MILLISECONDS_MULTIPLIER","toType","obj","toString","call","match","toLowerCase","getSpecialTransitionEndEvent","bindType","delegateType","handle","event","$","target","is","handleObj","handler","apply","arguments","undefined","transitionEndEmulator","duration","called","one","Util","setTimeout","triggerTransitionEnd","setTransitionEndSupport","fn","emulateTransitionEnd","special","getUID","prefix","Math","random","document","getElementById","getSelectorFromElement","element","selector","getAttribute","hrefAttr","trim","querySelector","err","getTransitionDurationFromElement","transitionDuration","css","transitionDelay","floatTransitionDuration","parseFloat","floatTransitionDelay","split","reflow","offsetHeight","trigger","supportsTransitionEnd","Boolean","isElement","nodeType","typeCheckConfig","componentName","config","configTypes","property","Object","prototype","hasOwnProperty","expectedTypes","value","valueType","RegExp","test","Error","toUpperCase","findShadowRoot","documentElement","attachShadow","getRootNode","root","ShadowRoot","parentNode","NAME","VERSION","DATA_KEY","EVENT_KEY","DATA_API_KEY","JQUERY_NO_CONFLICT","Default","list","prefetch","filter","filterDelay","filterMinChars","filterRelation","maxResult","onPick","onItemRendered","preProcess","DefaultType","Event","BLUR_DATA_API","CLICK_DATA_API","KEYDOWN_DATA_API","INPUT_DATA_API","PICK","ITEM_RENDER","KeyCode","ARROW_DOWN","ARROW_UP","ENTER","ESCAPE","Autocomplete","_config","_getConfig","_element","_items","_labels","_isShown","_dropdown","_spinner","_result","_query","_preventClose","_timer","_relations","hasAttribute","removeAttribute","TypeError","_handleRelations","setAttribute","_makeDropdown","_makeSpinner","_fetchPresetData","_addElementListener","show","length","_showDropdown","hide","_hideDropdown","dispose","off","removeData","clearTimeout","on","e","prevent","keyCode","altKey","_findFromList","_focusNext","_focusPrev","item","children","get","_selectItem","preventDefault","_truncateDropdown","dataList","Array","from","forEach","o","val","innerHTML","includes","push","_showSpinner","res","_hideSpinner","i","_findFromAjax","vval","url","replace","sep","k","el","local","_renderItem","label","next","focused","classList","remove","tmpNext","add","prev","name","change","style","display","position","tmpl","appendTo","right","top","offsetTop","items","itemEl","text","renderEvent","innerText","pickEvent","_jQueryInterface","relatedTarget","each","data","Constructor","noConflict"],"mappings":"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"}